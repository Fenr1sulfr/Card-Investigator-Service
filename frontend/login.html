<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Login | Aitu Project Challenge</title>
    <meta content='width=device-width, initial-scale=1.0, shrink-to-fit=no' name='viewport' />
    <link rel="icon" href="assets/img/kaiadmin/favicon.ico" type="image/x-icon" />

    <!-- Fonts and icons -->
    <script src="assets/js/plugin/webfont/webfont.min.js"></script>
    <script>
        WebFont.load({
            google: {
                "families": ["Public Sans:300,400,500,600,700"]
            },
            custom: {
                "families": ["Font Awesome 5 Solid", "Font Awesome 5 Regular", "Font Awesome 5 Brands", "simple-line-icons"],
                urls: ['assets/css/fonts.min.css']
            },
            active: function() {
                sessionStorage.fonts = true;
            }
        });
    </script>

    <!-- CSS Files -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/plugins.min.css">
    <link rel="stylesheet" href="assets/css/kaiadmin.min.css">
</head>

<body>
    <div class="container vh-100 d-flex justify-content-center align-items-center flex-column">
        <h1 id="logo">AITU Project Challenge</h1>
        <div class="col-md-5">
            <!-- Форма входа -->
            <form id="loginForm" novalidate>
                <div class="form-group ps-0">
                    <label for="loginEmail">Электронная почта</label>
                    <input type="email" class="form-control" id="loginEmail" placeholder="Введите почту" required>
                    <small class="form-text text-muted" style="display:none;">Пожалуйста, введите корректный email.</small>
                </div>
                <div class="form-group ps-0">
                    <label for="loginPassword">Пароль</label>
                    <input type="password" class="form-control" id="loginPassword" placeholder="Пароль" minlength="6" required>
                    <small class="form-text text-muted" style="display:none;">Пароль должен быть не менее 6 символов.</small>
                </div>
                <div class="form-check ps-0">
                    <input type="checkbox" class="form-check-input" id="rememberMe">
                    <label class="form-check-label" for="rememberMe">Запомнить меня</label>
                </div>
                <button type="submit" class="btn btn-primary">Войти</button>
                <div class="mt-3">
                    <a href="#">Забыли пароль?</a>
                    <span> | </span>
                    <a href="#" id="toRegister">Регистрация</a>
                </div>
            </form>

            <!-- Форма регистрации -->
            <form id="registerForm" style="display: none;" novalidate>
                <div class="form-group ps-0">
                    <label for="regUsername">Логин</label>
                    <input type="text" class="form-control" id="regUsername" placeholder="Логин" required>
                    <small class="form-text text-muted" style="display:none;">Введите логин.</small>
                </div>
                <div class="form-group ps-0">
                    <label for="regFirstName">Имя</label>
                    <input type="text" class="form-control" id="regFirstName" placeholder="Имя" required>
                    <small class="form-text text-muted" style="display:none;">Введите имя.</small>
                </div>
                <div class="form-group ps-0">
                    <label for="regLastName">Фамилия</label>
                    <input type="text" class="form-control" id="regLastName" placeholder="Фамилия" required>
                    <small class="form-text text-muted" style="display:none;">Введите фамилию.</small>
                </div>
                <div class="form-group ps-0">
                    <label for="regEmail">Электронная почта</label>
                    <input type="email" class="form-control" id="regEmail" placeholder="Введите почту" required>
                    <small class="form-text text-muted" style="display:none;">Пожалуйста, введите корректный email.</small>
                </div>
                <div class="form-group ps-0">
                    <label for="regPassword">Пароль</label>
                    <input type="password" class="form-control" id="regPassword" placeholder="Пароль" minlength="6" required>
                    <small class="form-text text-muted" style="display:none;">Пароль должен быть не менее 6 символов.</small>
                </div>
                <div class="form-group ps-0">
                    <label for="regConfirmPassword">Подтвердите пароль</label>
                    <input type="password" class="form-control" id="regConfirmPassword" placeholder="Подтвердите пароль" minlength="6" required>
                    <small class="form-text text-muted" style="display:none;">Пароли не совпадают.</small>
                </div>
                <button type="submit" class="btn btn-primary">Регистрация</button>
                <div class="mt-3">
                    <a href="#" id="toLogin">Уже есть аккаунт?</a>
                </div>
            </form>
        </div>
    </div>
    <script>
        const toRegister = document.getElementById('toRegister');
        const toLogin = document.getElementById('toLogin');
        const loginForm = document.getElementById('loginForm');
        const registerForm = document.getElementById('registerForm');
        const logo = document.getElementById('logo');

        toRegister.addEventListener('click', function(event) {
            event.preventDefault();
            loginForm.classList.add("animated", "fadeOut");
            logo.classList.add("animated", "fadeOut");
            setTimeout(() => {
                loginForm.style.display = 'none';
                registerForm.style.display = 'block';
                loginForm.classList.remove("animated", "fadeOut");
                registerForm.classList.add("animated", "fadeIn");
                logo.classList.remove("animated", "fadeOut");
                logo.classList.add("animated", "fadeIn");
                document.querySelector('.container').classList.remove('vh-100');
            }, 500);
        });

        toLogin.addEventListener('click', function(event) {
            event.preventDefault();
            registerForm.classList.add("animated", "fadeOut");
            logo.classList.add("animated", "fadeOut");
            setTimeout(() => {
                registerForm.style.display = 'none';
                loginForm.style.display = 'block';
                registerForm.classList.remove("animated", "fadeOut");
                loginForm.classList.add("animated", "fadeIn");
                logo.classList.remove("animated", "fadeOut");
                logo.classList.add("animated", "fadeIn");
                document.querySelector('.container').classList.add('vh-100');
            }, 500);
        });

        // Валидация формы входа
        loginForm.addEventListener('submit', function(event) {
            event.preventDefault();
            validateLoginForm();
        });

        function validateLoginForm() {
            const email = document.getElementById('loginEmail');
            const password = document.getElementById('loginPassword');

            let valid = true;

            if (!email.checkValidity()) {
                showError(email, 'Пожалуйста, введите корректный email.');
                valid = false;
            } else {
                showSuccess(email);
            }

            if (password.value.length < 6) {
                showError(password, 'Пароль должен быть не менее 6 символов.');
                valid = false;
            } else {
                showSuccess(password);
            }

            if (valid) {
                window.location.replace('profile.html')
            }
        }

        // Валидация формы регистрации
        registerForm.addEventListener('submit', function(event) {
            event.preventDefault();
            validateRegisterForm();
        });

        function validateRegisterForm() {
            const username = document.getElementById('regUsername');
            const firstName = document.getElementById('regFirstName');
            const lastName = document.getElementById('regLastName');
            const email = document.getElementById('regEmail');
            const password = document.getElementById('regPassword');
            const confirmPassword = document.getElementById('regConfirmPassword');

            let valid = true;

            if (username.value.trim() === '') {
                showError(username, 'Введите логин.');
                valid = false;
            } else {
                showSuccess(username);
            }

            if (firstName.value.trim() === '') {
                showError(firstName, 'Введите имя.');
                valid = false;
            } else {
                showSuccess(firstName);
            }

            if (lastName.value.trim() === '') {
                showError(lastName, 'Введите фамилию.');
                valid = false;
            } else {
                showSuccess(lastName);
            }

            if (!email.checkValidity()) {
                showError(email, 'Пожалуйста, введите корректный email.');
                valid = false;
            } else {
                showSuccess(email);
            }

            if (password.value.length < 6) {
                showError(password, 'Пароль должен быть не менее 6 символов.');
                valid = false;
            } else {
                showSuccess(password);
            }

            if (password.value !== confirmPassword.value) {
                showError(confirmPassword, 'Пароли не совпадают.');
                valid = false;
            } else if (password.value.trim() === '') {
                showError(confirmPassword, 'Поле не может быть пустым.')
                valid = false;
            } else {
                showSuccess(confirmPassword);
            }

            if (valid) {
                window.location.replace('profile.html');
            }
        }

        function showError(input, message) {
            const formGroup = input.parentElement;
            formGroup.classList.remove('has-success');
            formGroup.classList.add('has-error');
            const small = formGroup.querySelector('.form-text');
            small.style.display = 'block';
            small.textContent = message;
        }

        function showSuccess(input) {
            const formGroup = input.parentElement;
            formGroup.classList.remove('has-error');
            formGroup.classList.add('has-success');
            const small = formGroup.querySelector('.form-text');
            small.style.display = 'none';
        }
    </script>
    <style>
        .has-error .form-control {
            border-color: #dc3545;
        }
        
        .has-success .form-control {
            border-color: #28a745;
        }
        
        .has-error label {
            color: #dc3545;
        }
        
        .has-success label {
            color: #28a745;
        }
    </style>
</body>

</html>